<ul id="Categories" class="connectedSortable">
  <!-- IF STATEMENT FOR THE LOOP BELOW IS NOT WORKING SO IT IS COMMENTED OUT -->
  <% @categories.each do |cats| %>
      <!-- <% if cats.user_id == current_user.id || cats.id == 1 %> -->
          <div class="panel-group">
            <div class="panel text-left">
              <div class="panel-heading">
                <h4 class="panel-title">
                  <a data-toggle="collapse" href="#collapse<%= cats.id%>">
                    <%= cats.c_name %>
                  </a>
                </h4>
              </div>
              <div id="collapse<%= cats.id%>" class="panel-collapse collapse">
                <ul id="category_activities" class=".connectedSortable">
                  <% cats.activities.each do |activity| %>
                      <li class="list-group-item" >
                        <% if activity.hidden == false || activity.hidden == nil%>

                            <label class="my_label"><%= activity.a_name %></label>

                            <!-- Delete Activity -->
                            <%= link_to destroy_act_path(activity.id), method: :delete, data: { confirm: "Are you sure?" } do %>
                                <i class="fa fa-trash-o" aria-hidden="true" title="Delete"></i>
                            <% end %>


                            <!-- Edit activity -->
                            <button class="editActivity" style="border:none; padding:0; background-color: transparent">
                              <i class="fa fa-pencil fa-fw" aria-hidden="true" title="Edit" id="editActivity"></i>
                            </button>


                            <!-- Hide activity -->
                            <!-- link_to hide_act_path(activity.id), method: :post do %> -->
                            <button class="hideActivity" style="border:none; padding:0; background-color: transparent">
                              <i class="fa fa-eye" aria-hidden="true" title="Hide" id="item"></i>
                            </button>
                            <!-- % end %> -->

                        <% end %>
                  <% end %>
                  </li>
                </ul>
              </div>
            </div>
          </div>
      <% end %>
  <% end %>
</ul>

<ul id="Activities" class="connectedSortable" >
  <!-- List each activity in database -->
  <% @activities.each do |activity| %>
      <% if (activity.hidden == false || activity.hidden == nil) && activity.category_id == nil %>
          <li class="list-group-item" id="item" data-id="<%activity.id%>" style="list-style: none;">


            <!-- Display activity name -->

            <label class="my_label"><%= activity.a_name %></label>


            <!-- Delete Activity -->
            <%= link_to destroy_act_path(activity.id), method: :delete, data: { confirm: "Are you sure?" }, remote: true do %>
                <i class="fa fa-trash-o" aria-hidden="true" title="Delete"></i>
            <% end %>

            <!-- Edit activity -->
            <%= link_to edit_act_path(activity.id)do %>
                <button class="editActivity" style="border:none; padding:0; background-color: transparent">
                  <i class="fa fa-pencil fa-fw" aria-hidden="true" title="Edit" id="editActivity"></i>
                </button>
            <% end %>

            <!-- Hide activity -->
            <%= link_to activity, method: :post, :controller => :activities, :action => :set_hidden_true, remote: true do %>
                <button class="hideActivity" style="border:none; padding:0; background-color: transparent">
                  <i class="fa fa-eye" aria-hidden="true" title="Hide" id="item"></i>
                </button>
            <% end %>

          </li> <!-- End of list item -->
      <% end %> <!-- End of if statement -->
  <% end %> <!-- End of activity loop -->
</ul>

<script>
    var ready, set_positions;
    set_positions = function(){
        // loop through and give each task a data-pos
        // attribute that holds its position in the DOM
        $('.list-group-item').each(function(i){
            $(this).attr("data-pos",i+1);
        });
    }
    //    ready = function(){
    // call set_positions function
    set_positions();
    // ************NEW execept for #Activities
    $('#Activities').sortable({
        connectWith: ".connectedSortable"
    });
    $('#Activities').disableSelection();
    //        $('#Categories').sortable({
    //            connectWith: ".connectedSortable"
    //        });
    //        $('#Categories').disableSelection();
    $('#category_activities').sortable({
        connectWith: ".connectedSortable"
    });
    $('#category_activities').disableSelection();
    // *******end of NEW
    $('#Activities li').click(function (){
        var myid = $(this).attr('id');
        alert($(this).attr('id'));
    });
    // after the order changes
    $('#Activities').sortable().bind('sortupdate', function(e, ui) {
        // array to store new order
        var updated_order = []
        // set the updated positions
        set_positions();
        // populate the updated_order array with the new task positions
        $('#Activities li').each(function(i){
            updated_order.push({ id: $(this).attr('id'), position: i });
        });
        // send the updated order via ajax
        $.ajax({
            type: "PUT",
            url: '/home/sort',
            data: { order: updated_order }
        });
    });
    //        ******NEW 4/18/17
    $('#Categories li').click(function (){
        var myid = $(this).attr('id');
        alert($(this).attr('id'));
    });
    // after the order changes
    $('#Categories').sortable().bind('sortupdate', function(e, ui) {
        // array to store new order
        var updated_order = []
        // set the updated positions
        set_positions();
        // populate the updated_order array with the new task positions
        $('#Categories li').each(function(i){
            updated_order.push({ id: $(this).attr('id'), position: i });
        });
        // send the updated order via ajax
        $.ajax({
            type: "PUT",
            url: '/home/sort',
            data: { order: updated_order }
        });
    });
    $('#category_activities li').click(function (){
        var myid = $(this).attr('id');
        alert($(this).attr('id'));
    });
    // after the order changes
    $('#category_activities').sortable().bind('sortupdate', function(e, ui) {
        // array to store new order
        var updated_order = []
        // set the updated positions
        set_positions();
        // populate the updated_order array with the new task positions
        $('#category_activities li').each(function(i){
            updated_order.push({ id: $(this).attr('id'), position: i });
        });
        // send the updated order via ajax
        $.ajax({
            type: "PUT",
            url: '/home/sort',
            data: { order: updated_order }
        });
    });
    //    *****end of NEW 4/18/17
    //    }
</script>