<!--This is the partial to display the categories and their activities
    This code is basically a copy and paste of a specific portion of the home page
    This is used to update the categories without requiring a page refresh-->

<ul id="Categories" class="connectedSortable">
  <!--Loop through categories in database-->
  <% @categories.each do |cats| %>

      <!--Display only categories belonging to the user-->
      <% if cats.user_id == current_user.id %>

          <!--Link category to its id, needed for hide and destroy js-->
          <div id="edit_category_<%= cats.id%>">

            <!--Create panels to store activities-->
            <div class="panel-group">
              <div class="panel text-left">
                <div class="panel-heading" id='<%=cats.id%>'>
                  <h4 class="panel-title">

                    <!--Collapsible Panel linked to div "collapse" where ID specifies which
                        panel gets toggled to collapse or expand-->
                    <a data-toggle="collapse" href="#collapse<%= cats.id%>">
                      <%= cats.c_name %>

                      <!-- Link to destroy category path to delete category -->
                      <%= link_to destroy_cat_path(cats.id), method: :delete,
                                  data: { confirm: 'Warning! Deleting this category will delete all activities associated with it. Would you like to continue?' }, remote: true do %>
                          <!--Set trashcan icon as delete link_to-->
                          <i class="fa fa-trash-o" aria-hidden="true" title="Delete" style="padding-left: 2%;color: darkblue"></i>
                      <% end %>

                      <!--Link to edit category path to edit category -->
                      <%= link_to edit_cat_path(cats.id), remote:true do %>
                          <!--Set pencil icon as edit link_to-->
                          <i class="fa fa-pencil fa-fw" aria-hidden="true" title="Edit" id="editCategory" style="color: darkblue"></i>
                      <% end %>

                      <!--Link to unhide category path to unhide category-->
                      <%= link_to unhide_cat_path(cats.id), method: :post,remote: true do %>
                          <!--Set eye icon as unhide link_to-->
                          <i class="fa fa-eye" aria-hidden="true" title="Show Hidden" style="border:none; background-color: transparent; padding:0; color: darkblue"></i>
                      <% end %>
                    </a>
                  </h4>
                </div>

                <!--Each panel needs to have a unique ID so the collapsible knows
                    which div to expand or collapse-->
                <div id="collapse<%= cats.id%>" class="panel-collapse collapse">
                  <!--Give id to category with activities, used for destroy js-->
                  <ul id="category_activities<%=cats.id%>" class="activitiesWithCat">

                    <!--Loop through each activity within category-->
                    <% cats.activities.each do |activity| %>

                        <!--Display activities that are not hidden-->
                        <% if activity.hidden == false || activity.hidden == nil%>
                            <!--Give id to activities inside of category, used for hide js-->
                            <div id="edit_activity_<%= activity.id%>">

                              <!--Display activities, pass activity id to enable sorting-->
                              <li class="list-group-item" id='<%=activity.id%>'>

                                <!--Display activity name -->
                                <label class="my_label"><%= activity.a_name %></label>

                                <!-- Link to delete activity path to delete activity -->
                                <%= link_to destroy_act_path(activity.id), method: :delete,
                                            data: { confirm: "Are you sure?" }, remote: true do %>
                                    <!--Set trash can icon to destroy link_to-->
                                    <i class="fa fa-trash-o" aria-hidden="true" title="Delete" style="padding-left: 2%"></i>
                                <% end %>

                                <!-- Link to edit activity path to edit activity -->
                                <%= link_to edit_act_path(activity.id), remote: true do %>
                                    <!--Set pencil icon to edit link_to-->
                                    <i class="fa fa-pencil fa-fw" aria-hidden="true" title="Edit" id="editActivity"></i>
                                <% end %>

                                <!-- Link to hide activity path to hide activity -->
                                <%= link_to hide_act_path(activity.id),method: :post, remote: true do %>
                                    <!--Set eye slash icon to hide link_to-->
                                    <i class="fa fa-eye-slash" aria-hidden="true" title="Hide" id="item"></i>
                                <% end %>

                                <!--######################MABYE DELETE? #########################-->
                                <!--THIS IS TO DISPLAY TOTAL TIME -->
                                <!--<div id="total_time<%=activity.id%>">-->
                                <!--<p class = 'total_time_display'><%=activity.total_time%> minutes</p>-->
                                <!--</div>-->


                                <!--&lt;!&ndash;CODE TO DYNAMICALLY CREATE BUTTONS WITH UNIQUE IDS &ndash;&gt;-->
                                <!--<div class="scroll-pane">-->
                                <!--<% (0..12).each do |am| %>-->
                                    <!--<% if am < 12 %>-->
                                        <!--<label><%=am%>:00 AM</label>-->
                                        <!--<% (1..4).each do |amID| %>-->
                                            <!--<button class = 'unfilled', id = 'timeAct<%=activity.id%><%=am%><%=amID%>', onclick="changeImages(this.id,<%=activity.id%>)">-->
                                            <!--</button>-->
                                            <!--<% end %>-->
                                        <!--<% else %>-->
                                        <!--<label><%=am%>:00 PM</label>-->
                                        <!--<% (1..4).each do |amID| %>-->
                                            <!--<button class = 'unfilled', id = 'timeAct<%=activity.id%><%=am%><%=amID%>', onclick="changeImages(this.id,<%=activity.id%>)">-->
                                            <!--</button>-->
                                            <!--<% end %>-->
                                        <!--<% end %>-->

                                    <!--<% end %>-->

                                <!--<% (13..23).each do |pm| %>-->
                                    <!--<label><%=pm-12%>:00 PM</label>-->
                                    <!--<% (1..4).each do |pmID| %>-->
                                        <!--<button class = 'unfilled', id = 'timeAct<%=activity.id%><%=pm%><%=pmID%>', onclick="changeImages(this.id)">-->
                                        <!--</button>-->
                                        <!--<% end %>-->
                                    <!--<% end %>-->
                                <!--</div>-->

                              </li>
                            </div>
                        <% end %> <!--End of hidden if statement-->
                    <% end %> <!--End of activities loop-->
                  </ul>
                </div>
              </div>
            </div>
          </div>
      <% end %> <!--End of user if statement-->
  <% end %> <!--End of categories loop-->
</ul>